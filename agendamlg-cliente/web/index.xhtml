<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head>
        <title>Listado de Eventos</title>
    </h:head>
    <h:body>
        <ui:fragment rendered="#{usuarioManagedBean.id == -1}">
            <h:link outcome="login">Iniciar Sesion</h:link>
            <br/>
        </ui:fragment>
        <h:form>
        <h:commandLink action="#{usuarioManagedBean.cerrarSesion()}" rendered="#{usuarioManagedBean.id != -1}" value="Cerrar Sesion" />
        </h:form>
        <h:form>
            <hr></hr>
            <h3>Si lo deseas, introduce una ubicación (coordenadas cartesianas) y un radio en torno a ella en el cual buscar eventos</h3>
            <p><b>Serán ordenados de más cercano a más lejano</b></p>
            <h:selectBooleanCheckbox value="#{indexManagedBean.ordenarPorDistancia}"></h:selectBooleanCheckbox> Ordenar por distancia <br></br>
            <b>Posición:</b><br></br>
            X: <h:inputText value="#{indexManagedBean.dx}"></h:inputText> <b>,</b> Y: <h:inputText value="#{indexManagedBean.dy}"></h:inputText>
            <br></br><br></br>
            Radio: <h:inputText value="#{indexManagedBean.radio}"></h:inputText> Unidades
            <hr></hr>
            
            <ui:fragment rendered="#{usuarioManagedBean.id != -1}">
            <h3>Mostrar eventos de mi preferencia (mis categorias favoritas)</h3>
            <h:commandButton value="Mostrar eventos de mi preferencia" action="#{indexManagedBean.mostrarDeMiInteres()}"></h:commandButton>
            </ui:fragment>
            
            <h3>Mostrar eventos de las categorias que selecciones</h3>
            <h:selectManyListbox value="#{indexManagedBean.seleccionCategorias}">
                <f:selectItems value="#{crearEventoManagedBean.categorias}" var="categoria" itemLabel="#{categoria.nombre}" itemValue="#{categoria.id}" />
            </h:selectManyListbox>
            <br></br>
            <h:commandButton value="Mostrar de categorias seleccionadas" action="#{indexManagedBean.mostrarDeCategoriasSeleccionadas()}"></h:commandButton>
            <hr></hr>
        <h:dataTable value="#{indexManagedBean.eventos}" var="evento">
            <h:column>
                ${evento.validado==0?"*":""}
            </h:column>
            <h:column>
                <f:facet name="header">
                    Nombre
                </f:facet>
                ${evento.nombre}
            </h:column>
            <h:column>
                <f:facet name="header">
                    Descripcion
                </f:facet>
                ${evento.descripcion}
            </h:column>
            <h:column>
                <f:facet name="header">
                    Creador
                </f:facet>
                ${evento.creador.alias}
            </h:column>
            <h:column>
                <f:facet name="header">
                    Direccion
                </f:facet>
                ${evento.direccion}
            </h:column>
            <h:column>
                <f:facet name="header">
                    Precio
                </f:facet>
                ${evento.precio}
            </h:column>
            <h:column>
                <f:facet name="header">
                    Likes
                </f:facet>
                ${evento.likes}
            </h:column>
            <h:column>
                <f:facet name="header">
                    Fecha
                </f:facet>
                ${evento.fecha}
            </h:column>
            <h:column>
                    <h:commandLink action="#{eventoManagedBean.ver(evento)}" value="Ver" />
            </h:column>
        </h:dataTable>
        </h:form>
        <ui:fragment rendered="#{usuarioManagedBean.id != -1}">
            <p>
                <h:link outcome="perfil">Ver Perfil</h:link> -
                <h:link outcome="crearEvento">Subir Evento</h:link>
            </p>
        </ui:fragment>
        ${usuarioManagedBean.id}
    </h:body>
</html>

